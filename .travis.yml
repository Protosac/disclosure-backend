language: python

python:
 - "2.7"

sudo: required

cache:
  apt: true
  pip: true
  directories:
    - $HOME/.cache/pip
    - $HOME/data
    - $HOME/disclosure-backend/data

env:
    global:
         - XDG_CACHE_HOME=$HOME/.cache/

before_install:
  - sudo apt-get install graphviz

install:
  - pip install python-coveralls nose-cov
  - pip install -r requirements.txt
  - pip install -r requirements_dev.txt

script: # Run test or deploy
  - '[ "$TRAVIS_EVENT_TYPE" == "pull_request" ] && make test'
  - '[ "$TRAVIS_EVENT_TYPE" == "push" ] && make deploy'

after_success: # Upload coverage to coveralls.io
  - '[ "$TRAVIS_EVENT_TYPE" == "pull_request" ] && coveralls'
